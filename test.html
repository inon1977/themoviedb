<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css
    ">
    <link rel="stylesheet" href="/css/style.css">
  <title>Movie List</title>
</head>
<body>
  <h1>Popular Movies</h1>
  <div class="container">
    <div id="movieList" class="row"></div>
  </div>
  <script>
    const apiUrl = 'https://api.themoviedb.org/3/movie/popular';
    const apiKey = '9f6240a021740eece5bf1be86da47ce6';
    fetch(`${apiUrl}?api_key=${apiKey}`)
      .then(response => response.json())
      .then(data => {
        const movieList = document.getElementById('movieList');
        data.results.forEach(movie => {
          //declare / create elements: 
          const movieID = movie.id;
          const wrapperdiv = document.createElement('div');
          const overlaydiv = document.createElement('div');
          wrapperdiv.className = "col-md-4";
          const carddiv = document.createElement('div');
          carddiv.classList.add("movie");
          carddiv.style.backgroundImage = `url(https://image.tmdb.org/t/p/w500${movie.backdrop_path})`;
          const cardbodydiv = document.createElement('div');
          const li = document.createElement('li');
          const title = document.createElement('h5');
          const overview = document.createElement('p');
          const releaseDate = document.createElement('p');
          const poster = document.createElement('img');
          const cover = document.createElement('img');
          const moreDetailsBtn = document.createElement('a');
          const moreDetailsText = "More Details"
          poster.src = `https://image.tmdb.org/t/p/w200${movie.poster_path}`;
          cover.src = `https://image.tmdb.org/t/p/w500${movie.backdrop_path}`;
          
          //give classes / content 
          carddiv.className = "card";
          overlaydiv.className = "overlay"
          cardbodydiv.className = "card-body"
          title.className = "card-title";
          title.textContent = movie.title;
          overview.textContent = movie.overview;
          overview.className = "card-text ";
          releaseDate.textContent = `Release Date: ${movie.release_date}`;
          releaseDate.className = "position-absolute release_date";
          moreDetailsBtn.className = "btn btn-primary";
          moreDetailsBtn.textContent = moreDetailsText;
          moreDetailsBtn.setAttribute('data-bs-toggle', 'modal');
          moreDetailsBtn.setAttribute('data-bs-target', `#id-${movieID}`);
          
          //modal elements: 
          const modalWrapper = document.createElement("div");
          const modalDialog = document.createElement("div");
          const modalContent = document.createElement("div");
          const modalHeader = document.createElement("div");
          const modalTitle = document.createElement("h5");
          const modalCloseX = document.createElement("button");
          const modalBody = document.createElement("div");
          const modalBodyText = document.createElement("p");
          const modalFooter = document.createElement("div");
          const footerCloseBtn = document.createElement("button");

          modalWrapper.className = "modal fade";
          modalWrapper.setAttribute('data-bs-toggle', 'modal');
          modalWrapper.setAttribute('id',`id-${movieID}`);
          modalWrapper.setAttribute('aria-hidden', true)
          modalWrapper.setAttribute('tabindex', -1);
          modalDialog.className = "modal-dialog";
          modalContent.className = "modal-content";
          modalHeader.className = "modal-header";
          modalTitle.className = "modal-title";
          modalTitle.textContent = movie.title;
          modalCloseX.type = "button";
          modalCloseX.className = "btn-close";
          modalCloseX.setAttribute('data-bs-dismiss', 'modal');
          modalCloseX.setAttribute('aria-label', 'close');
          modalBody.className = "modal-body";
          modalBodyText.textContent = movie.overview;
          modalFooter.className = "modal-footer";
          footerCloseBtn.className = "btn btn-secondary";
          footerCloseBtn.type = "button";
          footerCloseBtn.setAttribute('data-bs-dismiss', 'modal')

          // put everything together in HTML
          movieList.appendChild(wrapperdiv);  
          wrapperdiv.appendChild(carddiv);
          cardbodydiv.appendChild(title);
          cardbodydiv.appendChild(overview);
          cardbodydiv.appendChild(moreDetailsBtn);
          cardbodydiv.appendChild(releaseDate);
          carddiv.appendChild(cardbodydiv);
          carddiv.appendChild(overlaydiv);
          //constructing the modal under each movie: 
          movieList.appendChild(modalWrapper);
          modalWrapper.appendChild(modalDialog);
          modalDialog.appendChild(modalContent);
          modalContent.appendChild(modalHeader);
          modalHeader.appendChild(modalTitle);
          modalHeader.appendChild(modalCloseX);
          modalContent.appendChild(modalBody);
          modalBody.appendChild(modalBodyText);
          
        });
      })
      .catch(error => {
        console.error('Error:', error);
      });
      const movieOverview = document.getElementsByClassName("card-text");
      function show_overview(){}
      console.log(movieOverview);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js
  "></script>
</body>
</html>